metadata:
  name: honeybee-radiance
  description: An operator to run all things honeybee and radiance!
  icon: https://www.ladybug.tools/assets/img/logo.png
  home: https://ladybug.tools/honeybee-radiance/docs
  sources:
  - https://github.com/ladybug-tools/honeybee-radiance

  tag: 1.2.3
  app_version: 2.3.2

  keywords:
  - honeybee
  - radiance
  - ladybug-tools

  maintainers:
  - name: mostapha
    email: mostapha@ladybug.tools

config:
  docker:
    image: ladybugtools/honeybee-radiance:2.3.2
    workdir: /opt/run/

functions:
- name: create-octree
  description: Generate an octree
  inputs:
    - name: model
      type: FunctionFileInput
      path: model.json
    - name: sky
      type: FunctionFileInput
      path: sky.sky
  command: honeybee radiance oconv -s sky.sky -m model.json --output scene.oct
  outputs:
    - name: scene-file
      type: FunctionFileOutput
      path: scene.oct

- name: 10000-lux-sky
  description: Generates a 10000 lux sky
  command: honeybee radiance sky illuminance 100000
  outputs:
    - name: sky
      type: FunctionFileOutput
      description: The resulting sky object
      path: sky.sky

- name: post-process
  description: Post process your results and $$$
  inputs:
    - name: raw-results-folder
      type: FunctionFolderInput
      path: raw
  command: honeybee radiance grid merge raw --folder output
  outputs:
    - name: post-process-folder
      type: FunctionFolderOutput
      path: output
    - name: daylight-factor-max
      type: FunctionStringOutput
      path: output/max
    - name: daylight-factor-average
      type: FunctionIntegerOutput
      path: output/avg

- name: ray-tracing
  description: Run ray tracing using some input data!
  inputs:
    - name: radiance-parameters
      type: FunctionStringInput
      description: a string of radiance parameters
      default: -ab 5
    - name: grid
      type: FunctionFileInput
      path: grid.pts
    - name: scene-file
      type: FunctionFileInput
      path: scene.oct
  command: rtrace -I -h {{inputs.radiance-parameters}} scene.oct < grid.pts > grid.res
  outputs:
    - name: result-file
      type: FunctionFileOutput
      path: grid.res
      
- name: split-grid
  inputs:
    - name: grid-count
      type: FunctionIntegerInput
    - name: grid
      type: FunctionFileInput
      description: The input grid to split
      path: grid.pts
  command: honeybee radiance grid split grid.pts --folder output --log-file output/grids.txt
  outputs:
    - name: grid-list
      type: FunctionArrayOutput
      path: output/grids.txt
    - name: output-grids-folder
      type: FunctionFolderOutput
      path: output
